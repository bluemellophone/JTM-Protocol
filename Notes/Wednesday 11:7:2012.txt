Notes for Wednesday, November 7th, 2012


--------------------- Project Elements ---------------------
Crypto Libraries: Crypto++ [http://www.cryptopp.com/]

Symmetric Encryption: AES-256
	256-bit (32-character) Session Key, discarded after every logout

Asymmetric Encryption: RSA (Two-way Authentication & Confidentiality)
	Public and Private Keys for ATM
	Public and Private Keys for Bank

Hash Function: SHA-512
	128-character Hexidecimal Hash

Nonces: Two-Way
	256-bit (32-character) Bank Nonce
	256-bit (32-character) ATM Nonce

Withdraw Limits = $1000 per day
Deposit Limits = $1000 per day
Transfer Limit = $1000 per day

--------------------- Project Data Structures ---------------------

Handshakes
	ATM Handshake = "handshake", New / First ATM Nonce, Random Padding to (1023 - 128 - 1)
	Hashed ATM Handshake = ATM Handshake, 128 Character SHA-512 ATM Handshake Hash 
	RSA Encrypted, Encoded ATM Handshake = Base64Encoding[ Encrypt^RSA-BANK PUBLIC KEY( Sign^RSA-ATM PRIVATE KEY( Hashed ATM Handshake ) ) ]

	Bank Handshake = "handshake", Last ATM Nonce, New / First Bank Nonce, AES Session Key, AES Session Block, Random Padding to (1023 - 128 - 1)
	Hashed Bank Handshake = Bank Handshake, 128 Character SHA-512 Bank Handshake Hash 
	RSA Encrypted, Encoded Bank Handshake = Base64Encoding[ Encrypt^RSA-ATM PUBLIC KEY( Sign^RSA-BANK PRIVATE KEY( Hashed Bank Handshake ) ) ]

Messages
	ATM Message = Command, Username, Card Number Hash, Pin, Dollar Amount, Transfer Username, New ATM Nonce, Last Bank Nonce, Random Padding to (1023 - 128 - 1)
	Bank Message = Command, Status, Last ATM Nonce, New Bank Nonce, Random Padding to (1023 - 128 - 1)
	
	Message Length = 1023-character Total Hashed Message Length - 128-character Message Hash - 1-character comma deliminator = 894 Characters

	Hashed Message = Message, 128 Character SHA-512 Message Hash
	Hashed Messgage Length = 1023 Characters

	AES Encrypted, Encoded Packet = Base64Encoding[ Encrypt^AES-SESSION KEY( Hashed Message ) ]
	AES Encrypted, Encoded Packet Length = 1408 Characters

	ATM Messages
		login, Username Hash, Card Number Hash, Pin Hash, NOT USED, NOT USED, New ATM Nonce, HANDSHAKE BANK NONCE
		balance, Username Hash, Card Number Hash, Pin Hash, NOT USED, NOT USED, New ATM Nonce, Last Bank Nonce
		withdraw, Username Hash, Card Number Hash, Pin Hash, Amount to Withdraw, NOT USED, New ATM Nonce, Last Bank Nonce
		transfer, Username Hash, Card Number Hash, Pin Hash, Amount to Transfer, Transfer Username Hash, New ATM Nonce, Last Bank Nonce
		logout, Username Hash, Card Number Hash, Pin Hash, NOT USED, NOT USED, New ATM Nonce, Last Bank Nonce

	Bank Messages
		login, If login successful, Last ATM Nonce, New Bank Nonce
		balance, Dollar amount of balance, Last ATM Nonce, New Bank Nonce
		withdraw, Dollar amount to withdraw, Last ATM Nonce, New Bank Nonce
		transfer, If transfer successful, Last ATM Nonce, New Bank Nonce
		logout, If logout successful, Last ATM Nonce, New Bank Nonce


XXX.card (card file for user XXX)
	User's Account Number = 128-character SHA-512 Hash

User Account Data Structure
	accountUsername
	accountCardNumberHash
	accountPinHash
	accountBalance  (protect against overflow and underflow)
	accountLoginAttempts
	accountLoginTimeout

